<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Devocional DiÃ¡rio</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>â˜€ï¸ Devocional DiÃ¡rio</h1>
    <p id="today-date"></p>
  </header>

  <main id="devocional-container">
    <div class="loading">Carregando devocional...</div>
  </main>

  <footer>
    <p>ğŸ“– Que este momento fortaleÃ§a sua fÃ© a cada amanhecer.</p>
    <p class="credit">Â© 2025 Um Dedo de FÃ©</p>
  </footer>

  <script>
    // ObtÃ©m a data de hoje no formato YYYY-MM-DD
    const today = new Date();
    const yyyy = today.getFullYear();
    const mm = String(today.getMonth() + 1).padStart(2, '0');
    const dd = String(today.getDate()).padStart(2, '0');
    const fileName = `${yyyy}-${mm}-${dd}.html`;

    document.getElementById('today-date').textContent =
      today.toLocaleDateString('pt-BR', { weekday: 'long', day: '2-digit', month: 'long', year: 'numeric' });

    const container = document.getElementById('devocional-container');

    // Tenta carregar o devocional do dia
    fetch(`entries/${fileName}`)
      .then(response => {
        if (!response.ok) {
          // Se nÃ£o achar, pega o Ãºltimo devocional disponÃ­vel
          return fetchLastAvailable();
        }
        return response.text();
      })
      .then(html => {
        container.innerHTML = html;
      })
      .catch(() => {
        container.innerHTML = "<p>NÃ£o foi possÃ­vel carregar o devocional de hoje.</p>";
      });

    // FunÃ§Ã£o para pegar o Ãºltimo devocional disponÃ­vel
    async function fetchLastAvailable() {
      const response = await fetch('entries/');
      const text = await response.text();
      const parser = new DOMParser();
      const doc = parser.parseFromString(text, 'text/html');
      const links = [...doc.querySelectorAll('a')]
        .map(a => a.getAttribute('href'))
        .filter(href => href.endsWith('.html'))
        .sort();
      const lastFile = links.pop();
      if (lastFile) {
        const lastResponse = await fetch(`entries/${lastFile}`);
        return lastResponse.text();
      } else {
        return "<p>Nenhum devocional disponÃ­vel ainda.</p>";
      }
    }
  </script>
</body>
</html>
